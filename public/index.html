<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1, width=device-width, shrink-to-fit=no"
    />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Aplicatie pentru monitorizarea COVID19 in Romania la nivel national si la nivel de judet"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
    <base href="/" />
    <meta property="og:title" content="Covid19RoStatus.ro" />
    <meta property="og:type" content="article" />
    <meta
      property="og:description"
      content="Cifrele epidemiei de COVID19 din Romania la nivel national si la nivel de judet"
    />
    <meta property="og:url" content="https://www.covid19rostatus.ro/" />
    <meta property="og:image" content="https://i.imgur.com/42hN6oV.png" />
    <meta property="fb:app_id" content="1531508340340887" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link
      href="https://fonts.googleapis.com/css?family=Baloo+Chettan+2&display=swap"
      rel="stylesheet"
    />
    <script
      data-ad-client="ca-pub-4993111640934621"
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
    ></script>
    <title>Covid19RoStatus</title>
    <style>
      #snackbar {
        min-width: 300px;
        margin-left: -125px;
        background-color: white;
        color: black;
        font-weight: bold;
        font-size: 18px;
        text-align: center;
        border-radius: 2px;
        padding: 16px;
        position: fixed;
        z-index: 1;
        left: 85%;
        transform: translate(-50%, -50%);
        bottom: 0px;
      }

      #snackbar.show {
        visibility: visible;
        -webkit-animation: fadein 0.5s;
        animation: fadein 0.5s;
      }

      @-webkit-keyframes fadein {
        from {
          bottom: 0;
          opacity: 0;
        }
        to {
          bottom: 30px;
          opacity: 1;
        }
      }

      @keyframes fadein {
        from {
          bottom: 0;
          opacity: 0;
        }
        to {
          bottom: 30px;
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <div id="snackbar">
      O noua versiune de aplicatie este disponobila. Click
      <a id="reload">aici</a> pentru a actualiza.
    </div>

    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->

    <script>
      let newWorker;

      function showUpdateBar() {
        let snackbar = document.getElementById("snackbar");
        snackbar.className = "show";
      }

      // The click event on the pop up notification
      document.getElementById("reload").addEventListener("click", function () {
        console.log("newWorker:", newWorker);
        newWorker.postMessage({ action: "skipWaiting" });
      });

      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("worker.js")
          .then((reg) => {
            console.log("reg:", reg);
            reg.addEventListener("updatefound", () => {
              // A wild service worker has appeared in reg.installing!
              console.log("reg.installing:", reg.installing);
              newWorker = reg.installing;
              console.log("newWorker:", newWorker);

              newWorker.addEventListener("statechange", () => {
                // Has network.state changed?
                switch (newWorker.state) {
                  case "installed":
                    if (navigator.serviceWorker.controller) {
                      // new update available
                      showUpdateBar();
                    }
                    // No update available
                    break;
                }
              });
            });
          })
          .catch(function (err) {
            console.log(err);
          });

        let refreshing;
        navigator.serviceWorker.addEventListener(
          "controllerchange",
          function () {
            console.log("refreshing INTRA AICIIII??:", refreshing);
            if (refreshing) return;
            window.location.reload();
            refreshing = true;
          }
        );
      } else {
        console.log("Service Worker is not supported by browser.");
      }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.0/d3.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-161540769-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-161540769-1");
    </script>

    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("worker.js")
            .then(
              function (registration) {
                console.log(
                  "Worker registration successful",
                  registration.scope
                );
              },
              function (err) {
                console.log("Worker registration failed", err);
              }
            )
            .catch(function (err) {
              console.log(err);
            });
        });
      } else {
        console.log("Service Worker is not supported by browser.");
      }
    </script>
  </body>
</html>
